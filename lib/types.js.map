{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/types.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n'use strict'\n\n#===========================================================================================================\nGUY                       = require 'guy'\n{ alert\n  debug\n  help\n  info\n  plain\n  praise\n  urge\n  warn\n  whisper }               = GUY.trm.get_loggers 'promptparser/types'\n{ rpr\n  inspect\n  echo\n  reverse\n  log     }               = GUY.trm\n{ Intertype }             = require 'intertype'\n#...........................................................................................................\ntypes                     = null\n\n#===========================================================================================================\nget_types = ->\n  return types if types?\n  types                     = new Intertype\n  { isa\n    type_of\n    validate\n    create                } = types\n  #.........................................................................................................\n  types.declare\n    #.......................................................................................................\n    positive_integer_or_infinity: ( x ) -> ( x is Infinity ) or ( @isa.positive.integer x )\n    #.......................................................................................................\n    pp_linenumber:    'positive.integer'\n    pp_content_id:    ( x ) -> ( @isa.text x ) and ( /^[0-9a-f]{16}$/.test x )\n    #.......................................................................................................\n    pp_prerecord_initial:\n      fields:\n        $key:         'text'\n        lnr:          ( x ) -> @isa.optional.pp_linenumber  x ### TAINT workaround due to missing feature ###\n        promptnr:     ( x ) -> @isa.optional.text           x ### TAINT workaround due to missing feature ###\n        prompt:       ( x ) -> @isa.optional.text           x ### TAINT workaround due to missing feature ###\n        prompt_id:    ( x ) -> @isa.optional.pp_content_id  x ### TAINT workaround due to missing feature ###\n        generations:  ( x ) -> @isa.optional.list           x ### TAINT workaround due to missing feature ###\n        comment:      ( x ) -> @isa.optional.text           x ### TAINT workaround due to missing feature ###\n        rejected:     ( x ) -> @isa.optional.boolean        x ### TAINT workaround due to missing feature ###\n      template:\n        $key:         'prerecord'\n        lnr:          null\n        promptnr:     null\n        prompt:       null\n        prompt_id:    null\n        generations:  null\n        comment:      null\n        rejected:     false\n    #.......................................................................................................\n    pp_prerecord_final:\n      fields:\n        $key:         'text'\n        lnr:          'positive.integer'\n        promptnr:     ( x ) -> @isa.optional.text x ### TAINT workaround due to missing feature ###\n        prompt:       'text'\n        prompt_id:    'pp_content_id'\n        generations:  ( x ) -> ( @isa.list x ) and ( x.every ( e ) => @isa.cardinal e ) ### TAINT workaround due to missing feature ###\n        comment:      ( x ) -> @isa.optional.text x ### TAINT workaround due to missing feature ###\n        rejected:     'boolean'\n      create: ( x ) ->\n        return x unless @isa.object x\n        return x\n    #.......................................................................................................\n    fm_constructor_cfg:\n      fields:\n        db_path:              'nonempty.text'\n        datasource_path:      ( x ) -> @isa.optional.nonempty.text x ### TAINT workaround due to missing feature ###\n        has_db_path:          'boolean'\n        has_datasource_path:  'boolean'\n        has_db:               'boolean'\n        trash_db:             'boolean'\n      create: ( db_path, datasource_path, trash_db = false ) ->\n        has_db_path         = db_path?\n        has_datasource_path = datasource_path?\n        ### NOTE `has_db_path` could conceivably be used to optionally open a temporary DB; only when that\n        DB actually exists would `has_db` be set to true; FTTB we don't do that so we here assume that in\n        case there's a `db_path` there will be a (functional, writable &c) DB file to access, and otherwise,\n        there will be no DB file. Observe that in any case, even if we did check for a file, we would still\n        have to test its fitness for the purpose, so other than a given `db_path` pointing to an unsuitable\n        location, there will remain failure modes that won't be captured by `has_db`. As such, `has_db` is\n        more of an advisory, informative property: 'act as if there is / there is no DB file'. ###\n        has_db              = has_db_path\n        has_datasource      = has_datasource_path\n        auto_populate_db    = has_db and has_datasource\n        return {\n          db_path,          has_db_path,          has_db,\n          datasource_path,  has_datasource_path,  has_datasource,\n          auto_populate_db,\n          trash_db, }\n    #.......................................................................................................\n    fm_table_name:          'nonempty.text'\n    fm_table_fields:        'object'\n    fm_insertion_record_object:\n      fields:\n        table:              'fm_table_name'\n        fields:             'fm_table_fields'\n    fm_insertion_record_list: ( x ) ->\n      return false unless @isa.list x\n      return x.every ( e ) => @isa.fm_insertion_record_object e\n    fm_insertion_records:\n      test:     ( x ) -> ( @isa.fm_insertion_record_object x ) or ( @isa.fm_insertion_record_list x )\n      create:   ( x ) ->\n        return x if @isa.fm_insertion_record_list x\n        return [ x, ]\n    #.......................................................................................................\n    pfr_constructor_cfg:\n      test:   'object'\n      fields:\n        ### inherited from fm_constructor_cfg ###\n        db_path:              'nonempty.text'\n        datasource_path:      ( x ) -> @isa.optional.nonempty.text x ### TAINT workaround due to missing feature ###\n        has_db_path:          'boolean'\n        has_datasource_path:  'boolean'\n        has_db:               'boolean'\n        ### own fields ###\n        cmd:                  'nonempty.text'\n        flags:                'object'\n      create: ( upstream_cfg, cmd, flags ) ->\n        R = { upstream_cfg..., cmd, flags, }\n        return R\n    #.......................................................................................................\n    cli_max_count:\n      test:                 'positive_integer_or_infinity'\n      template:             +Infinity\n      create:               ( x ) ->\n        return @declarations.cli_max_count.template unless x?\n        # return x unless /^\\+?\\d+$/.test x\n        Math.round parseFloat x\n    cli_foo:\n      test:                 'text'\n      create:               ( x ) -> rpr x\n    #.......................................................................................................\n    normalfloat:            ( x ) -> ( @isa.float x ) and 0 <= x <= 1\n    #.......................................................................................................\n    cli_sample:\n      test:                 'normalfloat'\n      template:             1\n      create: ( x ) ->\n        switch true\n          when not x?\n            return @declarations.cli_sample.template\n          when x.endsWith '%'\n            return ( ( parseFloat x ) / 100 )\n          when ( match = x.match /^(?<numerator>[0-9.]+)\\/(?<denominator>[0-9.]+)$/ )?\n            return ( ( parseFloat match.groups.numerator ) / parseFloat match.groups.denominator )\n        return parseFloat x\n    #.......................................................................................................\n    cli_seed:\n      test:                 'float'\n      template:             null\n      create: ( x ) ->\n        return @declarations.cli_sample.template unless x?\n        return parseFloat x\n    #.......................................................................................................\n    cli_match:\n      test:                 ( x ) -> @isa.optional.regex x ### TAINT workaround due to missing feature ###\n      template:             null\n      create: ( x ) ->\n        return null unless x?\n        return new RegExp x\n    #.......................................................................................................\n    cli_trash_db:\n      test:                 'boolean'\n      template:             false\n      create: ( x ) ->\n        return @declarations.cli_trash_db.template  unless x?\n        return true                                 if x is 'true'\n        return false                                if x is 'false'\n        return x\n    #.......................................................................................................\n    cli_db:\n      test:                 'nonempty.text'\n      template:             '/dev/shm/prompts-and-generations.sqlite'\n      create: ( x ) -> x ? @declarations.cli_db.template\n    #.......................................................................................................\n    cli_prompts:\n      test:                 'nonempty.text'\n      template:             null\n      create: ( x ) -> x\n\n\n  #.........................................................................................................\n  return types\n\n\n#===========================================================================================================\nmodule.exports = { get_types, }\n"
  ]
}